CREATE TABLE EMPLOYEE (
EMP_ID INT PRIMARY KEY,
EMP_NAME VARCHAR(50) NOT NULL,
DEPARTMENT VARCHAR(50),
SALARY INT,
CITY varchar(50)
);


INSERT INTO EMPLOYEE (EMP_ID,EMP_NAME,DEPARTMENT,SALARY,CITY)
VALUES 
(101,'JOHN','HR',50000,'NEW DELHI'),
(102,'ROBIN','QA',60000,'BANGALORE'),
(103,'ALYA','HR',35000,'CHENNAI'),
(104,'YUSUF','SYS',68000,'HYDERABAD'),
(105,'RAVI','SYS',62000,'BANGALORE'),
(106,'RAJ','HR',45000,'CHENNAI'),
(107,'JAYANT','SYS',25000,'RANCHI'),
(108,'PRATIK','OP',35000,'AHMEDABAD'),
(109,'NEIL','HR',25000,'BANGALORE');


SELECT COUNT(*),CITY FROM EMPLOYEE GROUP BY CITY HAVING COUNT(*) >=2;
SELECT COUNT(*)FROM EMPLOYEE;UNT(*),CITY FROM EMPLOYEE GROUP BY CITY;

--DEPARTMENT WISE TOTAL EMPLOYEES AND TOTAL SALARY
SELECT DEPARTMENT,
       COUNT(*) AS TOTAL_EMPLOYEE,
	   SUM(SALARY) AS TOTAL_SALARY
FROM EMPLOYEE
GROUP BY DEPARTMENT;

--CITY WISE AVG SALARY 
SELECT CITY,
     AVG(SALARY) AS AVG_SALARY
FROM EMPLOYEE
GROUP BY CITY;

--DEPARTMENT HAVING MORE THAN 2 EMPLOYEES
SELECT DEPARTMENT,
       COUNT(*),DEPARTMENT
	   FROM EMPLOYEE
GROUP BY DEPARTMENT HAVING COUNT(*)>=2;	 

--CITY WHERE AVG SALRY >60000

SELECT CITY,
      AVG(SALARY) AS AVG_SALARY
	  FROM EMPLOYEE
GROUP BY CITY 
HAVING AVG(SALARY) > 60000;
	  
	  
SELECT CITY,
AVG(SALARY) AS AVG_SALARY
FROM EMPLOYEE
GROUP BY CITY
HAVING AVG(SALARY) >40000;
	   
--DEPARTMENT WISE MAX AND MIN SALARY
SELECT DEPARTMENT, 
MAX(SALARY) AS MAX_SALARY,
MIN(SALARY) AS MIN_SALARY
FROM EMPLOYEE
GROUP BY DEPARTMENT;

--SHOW THE DEPARTMENTS WHERE TOTAL SALARY>150000

SELECT DEPARTMENT,
SUM(SALARY) AS TOTAL_SALARY
FROM EMPLOYEE
GROUP BY DEPARTMENT
HAVING SUM(SALARY)>150000;
	 
ALTER TABLE EMPLOYEE ADD JOINING_YEAR INT;

--YEAR-WISE NUMBER OF EMPLOYEES JOINED
SELECT joining_year,
       COUNT(*) AS emp_count
FROM employee
GROUP BY joining_year
HAVING COUNT(*) > 1;

-- FOR EACH DEPARTMENT ,FIND AVERAGE SALARY,BUT ONLY INCLUDE DEPARTMENTS WHERE MAX SALARY > 80000

SELECT DEPARTMENT,
      AVG(SALARY) AS AVG_SALARY
FROM EMPLOYEE
GROUP BY DEPARTMENT
HAVING MAX(SALARY) > 50000;
	  
--CITY WISE TOTAL SALRY ONLY FOR HR DEPARTMENT

SELECT CITY,
      SUM(SALARY) AS TOTAL_SALARY
FROM EMPLOYEE
WHERE DEPARTMENT ='HR'
GROUP BY CITY;

--DEPARTMENTS WHERE AVERAGE SALARYIS GREATER THAN OVERALL COMPANY 

SELECT DEPARTMENT,
     AVG(SALARY) AS DEPT_AVG
	 
FROM EMPLOYEE
GROUP BY DEPARTMENT
HAVING AVG(SALARY) > (
    SELECT AVG (SALARY)
    FROM EMPLOYEE
);
	 

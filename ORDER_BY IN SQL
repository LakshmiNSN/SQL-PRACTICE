CREATE TABLE EMPLOYEE (
EMP_ID INT PRIMARY KEY,
EMP_NAME VARCHAR(50) NOT NULL,
DEPARTMENT VARCHAR(50),
SALARY INT,
CITY varchar(50)
);


INSERT INTO EMPLOYEE (EMP_ID,EMP_NAME,DEPARTMENT,SALARY,CITY)
VALUES 
(101,'JOHN','HR',50000,'NEW DELHI'),
(102,'ROBIN','QA',60000,'BANGALORE'),
(103,'ALYA','HR',35000,'CHENNAI'),
(104,'YUSUF','SYS',68000,'HYDERABAD'),
(105,'RAVI','SYS',62000,'BANGALORE'),
(106,'RAJ','HR',45000,'CHENNAI'),
(107,'JAYANT','SYS',25000,'RANCHI'),
(108,'PRATIK','OP',35000,'AHMEDABAD'),
(109,'NEIL','HR',25000,'BANGALORE');



--BASIC SALARY
SELECT * FROM EMPLOYEE ORDER BY SALARY ASC;

---ORDER EMPLOYEE BY NAME ALPHABETICALLY
SELECT EMP_NAME
FROM EMPLOYEE
ORDER BY EMP_NAME;

--ODER BY DEPARTMENT THEN BY SALARY (HIGH TO LOW)
SELECT EMP_NAME,DEPARTMENT,SALARY
FROM EMPLOYEE
ORDER BY DEPARTMENT, SALARY DESC; 

--ORDER BY CITY THEN JOINING YEAR
SELECT EMP_NAME,JOINING_YEAR 
FROM EMPLOYEE
ORDER BY CITY , JOINING_YEAR DESC;

---ORDER BY WITH AGGREGATE FUNCTIONS
--DEPARTMENT WISE TOTAL SALARY ORDERED BY TOTAL SALARY(DESC)

SELECT DEPARTMENT ,
       SUM(SALARY)AS TOTAL_SALARY
FROM EMPLOYEE
GROUP BY DEPARTMENT
ORDER BY TOTAL_SALARY DESC;

--CITY WISE EMPLOYEE COUNY ORDERED BY COUNT (ASC)

SELECT CITY,
COUNT (EMP_ID)AS EMP_COUNT
FROM EMPLOYEE
GROUP BY CITY
ORDER BY EMP_COUNT ASC;


---DEPARTMENT WISE AVERAGE SALARY ORDERED BY AVERAGE SALARY(DESC)
SELECT DEPARTMENT,
AVG(SALARY) AS AVG_SALARY
FROM EMPLOYEE
GROUP BY DEPARTMENT
ORDER BY AVG_SALARY DESC;

---ORDER BY + HAVING 
-- DEPARTMENT HAVING MORE THAN 2 EMPLOYEES,ORDERED BY EMPLOYEE COUNT DESC
SELECT DEPARTMENT,
COUNT(EMP_ID)AS EMP_COUNT
FROM EMPLOYEE
GROUP BY DEPARTMENT
HAVING COUNT(EMP_ID)>2
ORDER BY EMP_COUNT DESC;

--CITIES WITH AVG SALARY > 60000 ORDERED BY AVG SALARY 

SELECT CITY ,
AVG(SALARY) AS AVG_SALARY 
FROM EMPLOYEE
GROUP BY CITY 
HAVING AVG(SALARY)>60000
ORDER BY AVG_SALARY;

--TRICKY HIGHEST PAID EMPLOYESS
SELECT EMP_NAME,SALARY
FROM EMPLOYEE
ODER BY SALARY DESC
LIMIT 3;

--LOWEST PAID EMPLOYEE IN EACH DEPARTMENT 
SELECT DEPARTMENT,
MIN(SALARY) AS LOWEST_SALARY
FROM EMPLOYEE
GROUP BY DEPARTMENT 
ORDER BY LOWEST_SALARY;

--ORDER EMPLOYEE BY SALARY DESC, IF SAME SALARY THEN BY NAME ASC
SELECT EMP_NAME,SALARY
FROM EMPLOYEE
ORDER BY SALARY DESC,EMP_NAME;

--TOP TWO CITIES WITH HIGHEST TOTAL SALARY
SELECT CITY ,
    SUM(SALARY) AS TOTAL_SALARY 
FROM EMPLOYEE
GROUP BY CITY
ORDER BY TOTAL_SALARY DESC
LIMIT 2;


